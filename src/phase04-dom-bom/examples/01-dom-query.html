<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DOM æŸ¥è¯¢æ–¹æ³•</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      h1 {
        text-align: center;
        color: #333;
      }
      h2 {
        color: #667eea;
        margin-top: 30px;
        border-bottom: 2px solid #667eea;
        padding-bottom: 8px;
      }
      .demo {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin: 15px 0;
      }
      pre {
        background: #2d2d2d;
        color: #f8f8f2;
        padding: 12px;
        border-radius: 6px;
        overflow-x: auto;
        font-size: 13px;
      }
      button {
        padding: 8px 16px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #5a6fd6;
      }
      .output {
        background: #f0f0f0;
        padding: 15px;
        border-radius: 6px;
        margin-top: 10px;
        min-height: 40px;
        font-family: monospace;
      }
      .highlight {
        background: #fff3cd;
        padding: 2px 6px;
        border-radius: 3px;
      }
      .item {
        padding: 8px;
        margin: 5px 0;
        background: #e3f2fd;
        border-radius: 4px;
      }
      ul {
        list-style: none;
        padding: 0;
      }
      li {
        padding: 8px;
        background: #f8f9fa;
        margin: 5px 0;
        border-radius: 4px;
      }
    </style>
  </head>
  <body>
    <h1>ğŸ” DOM æŸ¥è¯¢æ–¹æ³•</h1>

    <!-- getElementById -->
    <h2>1. getElementById()</h2>
    <div class="demo">
      <pre>document.getElementById('myId');</pre>
      <div
        id="unique-element"
        style="
          padding: 15px;
          background: linear-gradient(135deg, #667eea, #764ba2);
          color: white;
          border-radius: 8px;
        "
      >
        è¿™æ˜¯ä¸€ä¸ªå”¯ä¸€çš„å…ƒç´  (id="unique-element")
      </div>
      <button onclick="demo1()">è·å–å…ƒç´ </button>
      <div class="output" id="output1"></div>
    </div>

    <!-- querySelector -->
    <h2>2. querySelector() - è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…</h2>
    <div class="demo">
      <pre>
document.querySelector('.item');       // ç±»é€‰æ‹©å™¨
document.querySelector('#id');          // ID é€‰æ‹©å™¨
document.querySelector('div > p');      // ç»„åˆé€‰æ‹©å™¨
document.querySelector('[data-type]');  // å±æ€§é€‰æ‹©å™¨</pre
      >
      <div class="item">Item 1</div>
      <div class="item">Item 2</div>
      <div class="item">Item 3</div>
      <button onclick="demo2()">è·å–ç¬¬ä¸€ä¸ª .item</button>
      <div class="output" id="output2"></div>
    </div>

    <!-- querySelectorAll -->
    <h2>3. querySelectorAll() - è¿”å› NodeList</h2>
    <div class="demo">
      <pre>
const items = document.querySelectorAll('.list-item');
// è¿”å› NodeList (ç±»æ•°ç»„ï¼Œå¯ä»¥ forEach)
items.forEach(item => console.log(item));</pre
      >
      <ul id="myList">
        <li class="list-item">åˆ—è¡¨é¡¹ 1</li>
        <li class="list-item">åˆ—è¡¨é¡¹ 2</li>
        <li class="list-item">åˆ—è¡¨é¡¹ 3</li>
        <li class="list-item">åˆ—è¡¨é¡¹ 4</li>
      </ul>
      <button onclick="demo3()">è·å–æ‰€æœ‰åˆ—è¡¨é¡¹</button>
      <button onclick="demo3b()">é«˜äº®å¶æ•°é¡¹</button>
      <div class="output" id="output3"></div>
    </div>

    <!-- getElementsByClassName / getElementsByTagName -->
    <h2>4. getElementsByClassName / getElementsByTagName</h2>
    <div class="demo">
      <pre>
document.getElementsByClassName('class'); // HTMLCollection (åŠ¨æ€)
document.getElementsByTagName('div');      // HTMLCollection (åŠ¨æ€)

// æ³¨æ„: è¿”å›çš„æ˜¯ HTMLCollectionï¼Œä¸æ˜¯æ•°ç»„!</pre
      >
      <div class="box">Box 1</div>
      <div class="box">Box 2</div>
      <div class="box">Box 3</div>
      <button onclick="demo4()">è·å–æ‰€æœ‰ .box</button>
      <button onclick="demo4b()">æ·»åŠ æ–° Box</button>
      <div class="output" id="output4"></div>
    </div>

    <!-- éå† DOM -->
    <h2>5. éå† DOM æ ‘</h2>
    <div class="demo">
      <pre>
element.parentNode       // çˆ¶èŠ‚ç‚¹
element.children         // å­å…ƒç´  (HTMLCollection)
element.childNodes       // å­èŠ‚ç‚¹ (åŒ…å«æ–‡æœ¬èŠ‚ç‚¹)
element.firstElementChild / lastElementChild
element.nextElementSibling / previousElementSibling
element.closest('.parent')  // å‘ä¸ŠæŸ¥æ‰¾ç¥–å…ˆ</pre
      >
      <div id="parent">
        <div id="first">ç¬¬ä¸€ä¸ªå­å…ƒç´ </div>
        <div id="middle">ä¸­é—´å­å…ƒç´ </div>
        <div id="last">æœ€åä¸€ä¸ªå­å…ƒç´ </div>
      </div>
      <button onclick="demo5()">éå†æ¼”ç¤º</button>
      <div class="output" id="output5"></div>
    </div>

    <!-- closest -->
    <h2>6. closest() - å‘ä¸ŠæŸ¥æ‰¾</h2>
    <div class="demo">
      <pre>element.closest('.ancestor'); // æŸ¥æ‰¾æœ€è¿‘çš„ç¥–å…ˆï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰</pre>
      <div
        class="level-1"
        style="padding: 20px; background: #e3f2fd; border-radius: 8px"
      >
        Level 1
        <div
          class="level-2"
          style="
            padding: 15px;
            background: #bbdefb;
            border-radius: 6px;
            margin-top: 10px;
          "
        >
          Level 2
          <div
            class="level-3"
            style="
              padding: 10px;
              background: #90caf9;
              border-radius: 4px;
              margin-top: 10px;
            "
          >
            <button onclick="demo6(event)">ç‚¹æˆ‘æ‰¾ç¥–å…ˆ</button>
          </div>
        </div>
      </div>
      <div class="output" id="output6"></div>
    </div>

    <!-- matches -->
    <h2>7. matches() - åˆ¤æ–­å…ƒç´ æ˜¯å¦åŒ¹é…é€‰æ‹©å™¨</h2>
    <div class="demo">
      <pre>
element.matches('.class');  // è¿”å› true/false
// å¸¸ç”¨äºäº‹ä»¶å§”æ‰˜ä¸­åˆ¤æ–­ç›®æ ‡å…ƒç´ </pre
      >
      <div class="card active" id="card1">Card 1 (active)</div>
      <div class="card" id="card2">Card 2</div>
      <button onclick="demo7()">æ£€æµ‹å…ƒç´ </button>
      <div class="output" id="output7"></div>
    </div>

    <script>
      // 1. getElementById
      function demo1() {
        const el = document.getElementById("unique-element");
        document.getElementById("output1").innerHTML =
          `æ‰¾åˆ°å…ƒç´ : <code>${el.tagName}</code>, id="${el.id}", å†…å®¹="${el.textContent.trim()}"`;
      }

      // 2. querySelector
      function demo2() {
        const el = document.querySelector(".item");
        document.getElementById("output2").innerHTML =
          `ç¬¬ä¸€ä¸ª .item: "${el.textContent}"`;
        el.style.background = "#667eea";
        el.style.color = "white";
      }

      // 3. querySelectorAll
      function demo3() {
        const items = document.querySelectorAll(".list-item");
        document.getElementById("output3").innerHTML =
          `æ‰¾åˆ° ${items.length} ä¸ªå…ƒç´  (NodeList)<br>` +
          `ç±»å‹: ${Object.prototype.toString.call(items)}`;
      }

      function demo3b() {
        const items = document.querySelectorAll(".list-item");
        items.forEach((item, index) => {
          if (index % 2 === 1) {
            item.style.background = "#667eea";
            item.style.color = "white";
          } else {
            item.style.background = "#f8f9fa";
            item.style.color = "black";
          }
        });
      }

      // 4. getElementsByClassName (åŠ¨æ€é›†åˆ)
      function demo4() {
        const boxes = document.getElementsByClassName("box");
        document.getElementById("output4").innerHTML =
          `æ‰¾åˆ° ${boxes.length} ä¸ª .box å…ƒç´  (HTMLCollection - åŠ¨æ€é›†åˆ)`;
      }

      function demo4b() {
        const container = document.querySelector("h2:nth-of-type(4) + .demo");
        const newBox = document.createElement("div");
        newBox.className = "box";
        newBox.textContent = "New Box";
        container.insertBefore(newBox, container.querySelector("button"));

        // HTMLCollection ä¼šè‡ªåŠ¨æ›´æ–°
        const boxes = document.getElementsByClassName("box");
        document.getElementById("output4").innerHTML =
          `ç°åœ¨æœ‰ ${boxes.length} ä¸ª .box å…ƒç´  (åŠ¨æ€æ›´æ–°!)`;
      }

      // 5. éå† DOM
      function demo5() {
        const parent = document.getElementById("parent");
        const middle = document.getElementById("middle");

        let result = "çˆ¶å…ƒç´ éå†:<br>";
        result += `children.length: ${parent.children.length}<br>`;
        result += `firstElementChild: ${parent.firstElementChild.id}<br>`;
        result += `lastElementChild: ${parent.lastElementChild.id}<br><br>`;

        result += "å…„å¼Ÿå…ƒç´ éå†:<br>";
        result += `middle çš„å‰ä¸€ä¸ªå…„å¼Ÿ: ${middle.previousElementSibling.id}<br>`;
        result += `middle çš„åä¸€ä¸ªå…„å¼Ÿ: ${middle.nextElementSibling.id}`;

        document.getElementById("output5").innerHTML = result;
      }

      // 6. closest
      function demo6(event) {
        const btn = event.target;
        const level1 = btn.closest(".level-1");
        const level2 = btn.closest(".level-2");
        const level3 = btn.closest(".level-3");

        document.getElementById("output6").innerHTML =
          `ä»æŒ‰é’®å‘ä¸ŠæŸ¥æ‰¾:<br>` +
          `.level-3: ${level3 ? "æ‰¾åˆ°" : "æœªæ‰¾åˆ°"}<br>` +
          `.level-2: ${level2 ? "æ‰¾åˆ°" : "æœªæ‰¾åˆ°"}<br>` +
          `.level-1: ${level1 ? "æ‰¾åˆ°" : "æœªæ‰¾åˆ°"}`;
      }

      // 7. matches
      function demo7() {
        const card1 = document.getElementById("card1");
        const card2 = document.getElementById("card2");

        document.getElementById("output7").innerHTML =
          `card1.matches('.active'): ${card1.matches(".active")}<br>` +
          `card2.matches('.active'): ${card2.matches(".active")}<br>` +
          `card1.matches('.card'): ${card1.matches(".card")}`;
      }
    </script>
  </body>
</html>
